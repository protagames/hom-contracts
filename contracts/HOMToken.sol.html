<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts/HOMToken.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> HOMToken.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">96.3% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>104/108</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">73.08% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>38/52</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>20/20</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">96.3% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>104/108</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-yes">60×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">62×</span>
<span class="cline-any cline-yes">62×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-yes">180×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">50×</span>
<span class="cline-any cline-yes">50×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18×</span>
<span class="cline-any cline-yes">18×</span>
<span class="cline-any cline-yes">18×</span>
<span class="cline-any cline-yes">18×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">110×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">52×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">56×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">112×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">443×</span>
<span class="cline-any cline-yes">112×</span>
<span class="cline-any cline-yes">112×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">443×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">443×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">163×</span>
<span class="cline-any cline-yes">135×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">26×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">443×</span>
<span class="cline-any cline-yes">443×</span>
<span class="cline-any cline-yes">443×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">443×</span>
<span class="cline-any cline-yes">280×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">163×</span>
<span class="cline-any cline-yes">162×</span>
<span class="cline-any cline-yes">162×</span>
<span class="cline-any cline-yes">162×</span>
<span class="cline-any cline-yes">162×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">162×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">160×</span>
<span class="cline-any cline-yes">134×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">160×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-yes">27×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">160×</span>
<span class="cline-any cline-yes">82×</span>
<span class="cline-any cline-yes">82×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">82×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">69×</span>
<span class="cline-any cline-yes">41×</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">28×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">158×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">158×</span>
<span class="cline-any cline-yes">158×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
pragma solidity 0.8.9;
&nbsp;
import "@openzeppelin/contracts/utils/Address.sol";
import "@openzeppelin/contracts/token/ERC20/ERC20.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
&nbsp;
import "@uniswap/v2-periphery/contracts/interfaces/IUniswapV2Router02.sol";
import "@uniswap/v2-core/contracts/interfaces/IUniswapV2Factory.sol";
import "@uniswap/v2-core/contracts/interfaces/IUniswapV2Pair.sol";
import "./TimeLockTransactions.sol";
import "./WithdrawableOwnable.sol";
import "./AntiDumpOwnable.sol";
&nbsp;
/**
* Features:
*   Liquidity fee can go to all company. (Company configurable)
*   Enterprise ecosystem fee. (Company configurable)
*   Burn rate. (Company configurable up to a certain limit)
*   Total fees capped.
*   Dex volume based anti-whale anti dump fees. (Configurable to a certain extent by the company)
*   Time lock dex transactions.
*   Prevent people from creating dexpair without company authorization.
*/
contract HOMToken is ERC20, Ownable, TimeLockTransactions, WithdrawableOwnable, AntiDumpOwnable {
    using Address for address;
&nbsp;
    // @dev dead address
    address public constant DEAD_ADDRESS = 0x000000000000000000000000000000000000dEaD;
&nbsp;
    // @dev the fee the ecosystem takes. value uses decimals() as multiplicative factor
    uint256 public ecoSystemFee = 0;
&nbsp;
    // @dev which wallet will receive the ecosystem fee
    address public ecoSystemAddress;
&nbsp;
    // @dev the fee the liquidity takes. value uses decimals() as multiplicative factor
    uint256 public liquidityFee = 5 * 10**16; // 5%
&nbsp;
    // @dev which wallet will receive the ecosystem fee. If dead is used, it goes to the msgSender
    address public liquidityAddress;
&nbsp;
    // @dev the fee the burn takes. value uses decimals() as multiplicative factor
    uint256 public burnFee = 0; // 0%
&nbsp;
    // @dev the max value of the ordinary fees sum
    uint256 public constant FEE_LIMIT = 2 * 10**17; // 20%
&nbsp;
    // @dev the defauld dex router
    IUniswapV2Router02 public dexRouter;
&nbsp;
    // @dev just to simplify to the user, the total fees
    uint256 public totalFees = 0;
&nbsp;
    // @dev the total max value of the fees
    uint256 public numTokensSellToAddToLiquidity = 0;
&nbsp;
    // @dev mapping of excluded from fees elements
    mapping(address =&gt; bool) public isExcludedFromFees;
&nbsp;
    // @dev the default dex pair
    address immutable public dexPair;
&nbsp;
    // @dev what pairs are allowed to work in the token
    mapping(address =&gt; bool) public automatedMarketMakerPairs;
&nbsp;
    uint256 constant internal LIQUIFICATION_LIMIT_DENOMINATOR = 10**6;
&nbsp;
    constructor() ERC20("Heroes of Metaverse Token", "HOM") {
        uint256 initialSupply = 420000000 * 10**18;
        excludeFromFees(address(this), true);
        excludeFromFees(owner(), true);
        excludeFromFees(DEAD_ADDRESS, true);
&nbsp;
        ecoSystemAddress = owner();
        liquidityAddress = DEAD_ADDRESS;
&nbsp;
        _mint(owner(), initialSupply);
&nbsp;
        numTokensSellToAddToLiquidity = initialSupply / LIQUIFICATION_LIMIT_DENOMINATOR; // 0.000001% of supply -&gt; 420 tokens
&nbsp;
        // Create a uniswap pair for this new token
        dexRouter = IUniswapV2Router02(0x10ED43C718714eb63d5aA57B78B54704E256024E); // mainnet
&nbsp;
        dexPair = IUniswapV2Factory(dexRouter.factory()).createPair(address(this), dexRouter.WETH());
        _setAutomatedMarketMakerPair(dexPair, true);
&nbsp;
        _updateTotalFee();
&nbsp;
        emit ExcludeFromFees(owner(), true);
        emit ExcludeFromFees(address(this), true);
        emit ExcludeFromFees(DEAD_ADDRESS, true);
    }
&nbsp;
    function setNumTokensLimitToAddToLiquidity(uint256 newLimit) external onlyOwner {
        require(newLimit &gt;= totalSupply() / LIQUIFICATION_LIMIT_DENOMINATOR, "new limit is too low");
        numTokensSellToAddToLiquidity = newLimit;
        emit SetNumTokensSellToAddToLiquidity(newLimit);
    }
    event SetNumTokensSellToAddToLiquidity(uint256 newLimit);
&nbsp;
    function setAutomatedMarketMakerPair(address pair, bool value) external onlyOwner {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(pair != dexPair, "default pair cannot be changed");
        _setAutomatedMarketMakerPair(pair, value);
    }
&nbsp;
    function _setAutomatedMarketMakerPair(address pair, bool value) private onlyOwner {
        automatedMarketMakerPairs[pair] = value;
        emit SetAutomatedMarketMakerPair(pair, value);
    }
&nbsp;
    // @dev create and add a new pair for a given token
    function addNewPair(address tokenAddress) external onlyOwner returns (address np) {
        address newPair = IUniswapV2Factory(dexRouter.factory()).createPair(address(this), tokenAddress);
        _setAutomatedMarketMakerPair(newPair, true);
        emit AddNewPair(tokenAddress, newPair);
        return newPair;
    }
    event AddNewPair(address indexed tokenAddress, address indexed newPair);
&nbsp;
    receive() external payable {}
&nbsp;
    // @dev exclude an account to be taxed
    function excludeFromFees(address account, bool excluded) public onlyOwner {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(isExcludedFromFees[account] != excluded, "Already set");
        isExcludedFromFees[account] = excluded;
        emit ExcludeFromFees(account, excluded);
    }
&nbsp;
    // @dev internal use to checkif the total fee was reached
    function checkFeesChanged(uint256 _oldFee, uint256 _newFee) internal view {
        uint256 _fees = ecoSystemFee + liquidityFee + burnFee + _newFee - _oldFee;
        <span class="missing-if-branch" title="else path not taken" >E</span>require(_fees &lt;= FEE_LIMIT, "Fees exceeded max limitation");
    }
&nbsp;
    // @dev set ecosystem address to receive fees
    function setEcoSystemAddress(address newAddress) external onlyOwner {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(newAddress != address(0), "zero address not allowed");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(ecoSystemAddress != newAddress, "EcoSystem address already set");
        ecoSystemAddress = newAddress;
        emit EcoSystemAddressUpdated(newAddress);
    }
&nbsp;
    // @dev set ecosystem tax to receive fees
    function setEcosystemFee(uint256 newFee) external onlyOwner {
        checkFeesChanged(ecoSystemFee, newFee);
        ecoSystemFee = newFee;
        _updateTotalFee();
        emit EcosystemFeeUpdated(newFee);
    }
&nbsp;
    // @dev set liquidity address to receive fees, if is set to dead, the lp token goes to the user
    function setLiquidityAddress(address newAddress) external onlyOwner {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(newAddress != address(0), "zero address not allowed");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(liquidityAddress != newAddress, "Liquidity address already set");
        liquidityAddress = newAddress;
        emit LiquidityAddressUpdated(newAddress);
    }
&nbsp;
    // @dev set liquidity tax
    function setLiquidityFee(uint256 newFee) external onlyOwner {
        checkFeesChanged(liquidityFee, newFee);
        liquidityFee = newFee;
        _updateTotalFee();
        emit LiquidityFeeUpdated(newFee);
    }
&nbsp;
    // @set the liquidity fee
    function setBurnFee(uint256 newFee) external onlyOwner {
        checkFeesChanged(burnFee, newFee);
        burnFee = newFee;
        _updateTotalFee();
        emit BurnFeeUpdated(newFee);
    }
&nbsp;
    function _updateTotalFee() internal {
        totalFees = liquidityFee + burnFee + ecoSystemFee;
    }
&nbsp;
    function _swapAndLiquify(uint256 amount, address cakeReceiver) private {
        uint256 half = amount / 2;
        uint256 otherHalf = amount - half;  // token
&nbsp;
        uint256 initialAmount = address(this).balance;
&nbsp;
        _swapTokensForBNB(half);
&nbsp;
        uint256 newAmount = address(this).balance - initialAmount;  // bnb
&nbsp;
        _addLiquidity(otherHalf, newAmount, cakeReceiver);
&nbsp;
        emit SwapAndLiquify(half, newAmount, otherHalf);
    }
&nbsp;
    function _swapTokensForBNB(uint256 tokenAmount) private {
        address[] memory path = new address[](2);
        path[0] = address(this);
        path[1] = dexRouter.WETH();
&nbsp;
        _approve(address(this), address(dexRouter), tokenAmount);
&nbsp;
        dexRouter.swapExactTokensForETHSupportingFeeOnTransferTokens(
            tokenAmount, // The amount of input tokens to send.
            0, // The minimum amount of BNB that must be received for the transaction not to revert.
            path, // An array of token addresses. path.length must be &gt;= 2. Pools for each consecutive pair of addresses must exist and have liquidity.
            address(this), // Recipient of the ETH.
            block.timestamp // Unix timestamp after which the transaction will revert.
        );
    }
&nbsp;
    function _addLiquidity(uint256 tokenAmount, uint256 bnbAmount, address cakeReceiver) private {
        _approve(address(this), address(dexRouter), tokenAmount);
&nbsp;
        dexRouter.addLiquidityETH{ value: bnbAmount }(
            address(this), // A pool token.
            tokenAmount, // The amount of token to add as liquidity if the WETH/token price is &lt;= msg.value/amountTokenDesired (token depreciates).
            0, // Bounds the extent to which the WETH/token price can go up before the transaction reverts. Must be &lt;= amountTokenDesired.
            0, // Bounds the extent to which the token/WETH price can go up before the transaction reverts. Must be &lt;= msg.value.
            cakeReceiver, // Recipient of the liquidity tokens.
            block.timestamp // Unix timestamp after which the transaction will revert.
        );
    }
&nbsp;
    function compareStrings(string memory a, string memory b) public pure returns (bool) {
        return (keccak256(abi.encodePacked((a))) == keccak256(abi.encodePacked((b))));
    }
&nbsp;
    // @dev Protect against the usage of unauthorized pancake pairs. Reason: without this if someone creates another pair and this contract do not know it, all transactions will pass without dex fees on that given pair.
    modifier _checkIfPairIsAuthorized(address from, address to) {
        // if the contract has symbol and the name is Cake-LP, it is a pancake pair
        if(Address.isContract(from) &amp;&amp; !automatedMarketMakerPairs[from]) {
            try IUniswapV2Pair(from).symbol() returns (string memory _value) {
                <span class="missing-if-branch" title="if path not taken" >I</span>if(compareStrings(_value, "Cake-LP"))
<span class="cstat-no" title="statement not covered" >                    revert("pair not allowed")</span>;
            }
            catch {}
        }
        <span class="missing-if-branch" title="if path not taken" >I</span>if(Address.isContract(to) &amp;&amp; !automatedMarketMakerPairs[to]) {
<span class="cstat-no" title="statement not covered" >            try IUniswapV2Pair(to).symbol() returns (string memory _value) {</span>
<span class="cstat-no" title="statement not covered" >                if(compareStrings(_value, "Cake-LP"))</span>
<span class="cstat-no" title="statement not covered" >                    revert("pair not allowed")</span>;
            }
            catch {}
        }
        _;
    }
&nbsp;
    function timeLockCheck(address from, address to) internal {
        if(automatedMarketMakerPairs[to])  // selling tokens
            lockIfCanOperateAndRevertIfNotAllowed(from);
        else if(automatedMarketMakerPairs[from]) // buying tokens
            lockIfCanOperateAndRevertIfNotAllowed(to);
    }
&nbsp;
    function _transfer(
        address from,
        address to,
        uint256 amount
    ) internal override
    _checkIfPairIsAuthorized(from, to)
    {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(from != address(0), "ERC20: transfer from the zero address");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(to != address(0), "ERC20: transfer to the zero address");
        <span class="missing-if-branch" title="else path not taken" >E</span>require(amount &gt; 0, "Transfer amount must be greater than zero");
&nbsp;
        if (isExcludedFromFees[from] || isExcludedFromFees[to]) {
            super._transfer(from, to, amount);
        } else {
            // timelock dex transactions
            timeLockCheck(from,to);
            uint256 extraFee = 0;
            uint256 tokenToEcoSystem=0;
            uint256 tokensToLiquidity=0;
            uint256 tokensToBurn=0;
&nbsp;
            // dex based fees
            // automatedMarketMakerPairs[from] -&gt; buy tokens on dex
            // automatedMarketMakerPairs[to]   -&gt; sell tokens on dex
            if(automatedMarketMakerPairs[to] || automatedMarketMakerPairs[from]) {
                // apply extra fee only on token sell operations
                if(automatedMarketMakerPairs[to])
                    extraFee = getAntiDumpFee(to,amount);
&nbsp;
                // apply ecoSystemFee if enabled
                if (ecoSystemFee &gt; 0 || extraFee &gt; 0) {
                    tokenToEcoSystem = amount * (ecoSystemFee + extraFee) / (10 ** decimals());
                    super._transfer(from, ecoSystemAddress, tokenToEcoSystem);
                }
&nbsp;
                // apply liquidity fee
                if (liquidityFee &gt; 0) {
                    tokensToLiquidity = amount * liquidityFee / (10 ** decimals());
                    super._transfer(from, address(this), tokensToLiquidity);
&nbsp;
                    // SELL _swapAndLiquify fails if we add liquidity and from == dexPair. it is a uniswap known issue
                    if(automatedMarketMakerPairs[to]){
                        // Company receives lp token
                        if(liquidityAddress != DEAD_ADDRESS){
                            if (balanceOf(address(this)) &gt;= numTokensSellToAddToLiquidity)
                                _swapAndLiquify(balanceOf(address(this)), liquidityAddress);
                        }
                        // Cashback the user with LP token
                        else
                            _swapAndLiquify(tokensToLiquidity, from);
                    }
                    // The LP token from BUY and will be stored inside the contract until the company withdraws it
                }
            }
&nbsp;
            // apply burn fees always
            if (burnFee &gt; 0) {
                tokensToBurn = amount * (burnFee) / (10 ** decimals());
                super._transfer(from, DEAD_ADDRESS, tokensToBurn);
            }
&nbsp;
            uint256 amountMinusFees = amount - tokenToEcoSystem - tokensToLiquidity - tokensToBurn;
            super._transfer(from, to, amountMinusFees);
        }
    }
&nbsp;
    event ExcludeFromFees(address indexed account, bool isExcluded);
    event LiquidityAddressUpdated(address indexed liquidityAddress);
    event EcoSystemAddressUpdated(address indexed ecoSystemAddress);
    event SetAutomatedMarketMakerPair(address indexed pair, bool indexed value);
    event SwapAndLiquify(
        uint256 indexed tokensSwapped,
        uint256 indexed bnbReceived,
        uint256 indexed tokensIntoLiqudity
    );
    event EcosystemFeeUpdated(uint256 indexed fee);
    event LiquidityFeeUpdated(uint256 indexed fee);
    event BurnFeeUpdated(uint256 indexed fee);
}</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon May 30 2022 21:22:32 GMT+0000 (Coordinated Universal Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
